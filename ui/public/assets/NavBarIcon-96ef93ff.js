(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function w(){}const zt=e=>e;function lt(e,n){for(const t in n)e[t]=n[t];return e}function ue(e){return e()}function Zt(){return Object.create(null)}function J(e){e.forEach(ue)}function ht(e){return typeof e=="function"}function Rt(e,n){return e!=e?n==n:e!==n||e&&typeof e=="object"||typeof e=="function"}function Se(e){return Object.keys(e).length===0}function Dn(e,n,t,i){if(e){const s=he(e,n,t,i);return e[0](s)}}function he(e,n,t,i){return e[1]&&i?lt(t.ctx.slice(),e[1](i(n))):t.ctx}function Bn(e,n,t,i){if(e[2]&&i){const s=e[2](i(t));if(n.dirty===void 0)return s;if(typeof s=="object"){const r=[],c=Math.max(n.dirty.length,s.length);for(let o=0;o<c;o+=1)r[o]=n.dirty[o]|s[o];return r}return n.dirty|s}return n.dirty}function Fn(e,n,t,i,s,r){if(s){const c=he(n,t,i,r);e.p(c,s)}}function In(e){if(e.ctx.length>32){const n=[],t=e.ctx.length/32;for(let i=0;i<t;i++)n[i]=-1;return n}return-1}function xt(e){const n={};for(const t in e)t[0]!=="$"&&(n[t]=e[t]);return n}function _t(e){return e??""}const fe=typeof window<"u";let jt=fe?()=>window.performance.now():()=>Date.now(),Ht=fe?e=>requestAnimationFrame(e):w;const st=new Set;function de(e){st.forEach(n=>{n.c(e)||(st.delete(n),n.f())}),st.size!==0&&Ht(de)}function Yt(e){let n;return st.size===0&&Ht(de),{promise:new Promise(t=>{st.add(n={c:e,f:t})}),abort(){st.delete(n)}}}function q(e,n){e.appendChild(n)}function ye(e){if(!e)return document;const n=e.getRootNode?e.getRootNode():e.ownerDocument;return n&&n.host?n:e.ownerDocument}function Ee(e){const n=j("style");return Me(ye(e),n),n.sheet}function Me(e,n){return q(e.head||e,n),n.sheet}function Qt(e,n,t){e.insertBefore(n,t||null)}function ft(e){e.parentNode&&e.parentNode.removeChild(e)}function Kn(e,n){for(let t=0;t<e.length;t+=1)e[t]&&e[t].d(n)}function j(e){return document.createElement(e)}function me(e){return document.createTextNode(e)}function Jt(){return me(" ")}function Un(){return me("")}function we(e,n,t,i){return e.addEventListener(n,t,i),()=>e.removeEventListener(n,t,i)}function S(e,n,t){t==null?e.removeAttribute(n):e.getAttribute(n)!==t&&e.setAttribute(n,t)}function Pe(e){return Array.from(e.childNodes)}function Nn(e,n){n=""+n,e.wholeText!==n&&(e.data=n)}function zn(e,n){e.value=n??""}function X(e,n,t,i){t===null?e.style.removeProperty(n):e.style.setProperty(n,t,i?"important":"")}function jn(e,n){for(let t=0;t<e.options.length;t+=1){const i=e.options[t];if(i.__value===n){i.selected=!0;return}}e.selectedIndex=-1}function Hn(e){const n=e.querySelector(":checked")||e.options[0];return n&&n.__value}function Le(e,n,{bubbles:t=!1,cancelable:i=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(e,t,i,n),s}const vt=new Map;let bt=0;function Oe(e){let n=5381,t=e.length;for(;t--;)n=(n<<5)-n^e.charCodeAt(t);return n>>>0}function Ce(e,n){const t={stylesheet:Ee(n),rules:{}};return vt.set(e,t),t}function kt(e,n,t,i,s,r,c,o=0){const l=16.666/i;let a=`{
`;for(let g=0;g<=1;g+=l){const v=n+(t-n)*r(g);a+=g*100+`%{${c(v,1-v)}}
`}const h=a+`100% {${c(t,1-t)}}
}`,u=`__svelte_${Oe(h)}_${o}`,m=ye(e),{stylesheet:f,rules:d}=vt.get(m)||Ce(m,e);d[u]||(d[u]=!0,f.insertRule(`@keyframes ${u} ${h}`,f.cssRules.length));const y=e.style.animation||"";return e.style.animation=`${y?`${y}, `:""}${u} ${i}ms linear ${s}ms 1 both`,bt+=1,u}function At(e,n){const t=(e.style.animation||"").split(", "),i=t.filter(n?r=>r.indexOf(n)<0:r=>r.indexOf("__svelte")===-1),s=t.length-i.length;s&&(e.style.animation=i.join(", "),bt-=s,bt||De())}function De(){Ht(()=>{bt||(vt.forEach(e=>{const{ownerNode:n}=e.stylesheet;n&&ft(n)}),vt.clear())})}let ut;function at(e){ut=e}function Be(){if(!ut)throw new Error("Function called outside component initialization");return ut}function pe(e){Be().$$.on_mount.push(e)}function ge(e,n){const t=e.$$.callbacks[n.type];t&&t.slice().forEach(i=>i.call(this,n))}const it=[],Kt=[],yt=[],Ut=[],Fe=Promise.resolve();let Nt=!1;function Ie(){Nt||(Nt=!0,Fe.then(xe))}function rt(e){yt.push(e)}function Yn(e){Ut.push(e)}const Mt=new Set;let tt=0;function xe(){if(tt!==0)return;const e=ut;do{try{for(;tt<it.length;){const n=it[tt];tt++,at(n),Ke(n.$$)}}catch(n){throw it.length=0,tt=0,n}for(at(null),it.length=0,tt=0;Kt.length;)Kt.pop()();for(let n=0;n<yt.length;n+=1){const t=yt[n];Mt.has(t)||(Mt.add(t),t())}yt.length=0}while(it.length);for(;Ut.length;)Ut.pop()();Nt=!1,Mt.clear(),at(e)}function Ke(e){if(e.fragment!==null){e.update(),J(e.before_update);const n=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,n),e.after_update.forEach(rt)}}let ct;function $t(){return ct||(ct=Promise.resolve(),ct.then(()=>{ct=null})),ct}function Z(e,n,t){e.dispatchEvent(Le(`${n?"intro":"outro"}${t}`))}const mt=new Set;let O;function Qn(){O={r:0,c:[],p:O}}function $n(){O.r||J(O.c),O=O.p}function Vt(e,n){e&&e.i&&(mt.delete(e),e.i(n))}function _e(e,n,t,i){if(e&&e.o){if(mt.has(e))return;mt.add(e),O.c.push(()=>{mt.delete(e),i&&(t&&e.d(1),i())}),e.o(n)}else i&&i()}const Gt={duration:0};function Vn(e,n,t){const i={direction:"in"};let s=n(e,t,i),r=!1,c,o,l=0;function a(){c&&At(e,c)}function h(){const{delay:m=0,duration:f=300,easing:d=zt,tick:y=w,css:g}=s||Gt;g&&(c=kt(e,0,1,f,m,d,g,l++)),y(0,1);const v=jt()+m,R=v+f;o&&o.abort(),r=!0,rt(()=>Z(e,!0,"start")),o=Yt(k=>{if(r){if(k>=R)return y(1,0),Z(e,!0,"end"),a(),r=!1;if(k>=v){const x=d((k-v)/f);y(x,1-x)}}return r})}let u=!1;return{start(){u||(u=!0,At(e),ht(s)?(s=s(i),$t().then(h)):h())},invalidate(){u=!1},end(){r&&(a(),r=!1)}}}function Gn(e,n,t){const i={direction:"out"};let s=n(e,t,i),r=!0,c;const o=O;o.r+=1;function l(){const{delay:a=0,duration:h=300,easing:u=zt,tick:m=w,css:f}=s||Gt;f&&(c=kt(e,1,0,h,a,u,f));const d=jt()+a,y=d+h;rt(()=>Z(e,!1,"start")),Yt(g=>{if(r){if(g>=y)return m(0,1),Z(e,!1,"end"),--o.r||J(o.c),!1;if(g>=d){const v=u((g-d)/h);m(1-v,v)}}return r})}return ht(s)?$t().then(()=>{s=s(i),l()}):l(),{end(a){a&&s.tick&&s.tick(1,0),r&&(c&&At(e,c),r=!1)}}}function Wn(e,n,t,i){const s={direction:"both"};let r=n(e,t,s),c=i?0:1,o=null,l=null,a=null;function h(){a&&At(e,a)}function u(f,d){const y=f.b-c;return d*=Math.abs(y),{a:c,b:f.b,d:y,duration:d,start:f.start,end:f.start+d,group:f.group}}function m(f){const{delay:d=0,duration:y=300,easing:g=zt,tick:v=w,css:R}=r||Gt,k={start:jt()+d,b:f};f||(k.group=O,O.r+=1),o||l?l=k:(R&&(h(),a=kt(e,c,f,y,d,g,R)),f&&v(0,1),o=u(k,y),rt(()=>Z(e,f,"start")),Yt(x=>{if(l&&x>l.start&&(o=u(l,y),l=null,Z(e,o.b,"start"),R&&(h(),a=kt(e,c,o.b,o.duration,0,g,r.css))),o){if(x>=o.end)v(c=o.b,1-c),Z(e,o.b,"end"),l||(o.b?h():--o.group.r||J(o.group.c)),o=null;else if(x>=o.start){const M=x-o.start;c=o.a+o.d*g(M/o.duration),v(c,1-c)}}return!!(o||l)}))}return{run(f){ht(r)?$t().then(()=>{r=r(s),m(f)}):m(f)},end(){h(),o=l=null}}}function Xn(e,n,t){const i=e.$$.props[n];i!==void 0&&(e.$$.bound[i]=t,t(e.$$.ctx[i]))}function ve(e){e&&e.c()}function Wt(e,n,t,i){const{fragment:s,after_update:r}=e.$$;s&&s.m(n,t),i||rt(()=>{const c=e.$$.on_mount.map(ue).filter(ht);e.$$.on_destroy?e.$$.on_destroy.push(...c):J(c),e.$$.on_mount=[]}),r.forEach(rt)}function Xt(e,n){const t=e.$$;t.fragment!==null&&(J(t.on_destroy),t.fragment&&t.fragment.d(n),t.on_destroy=t.fragment=null,t.ctx=[])}function Ue(e,n){e.$$.dirty[0]===-1&&(it.push(e),Ie(),e.$$.dirty.fill(0)),e.$$.dirty[n/31|0]|=1<<n%31}function St(e,n,t,i,s,r,c,o=[-1]){const l=ut;at(e);const a=e.$$={fragment:null,ctx:[],props:r,update:w,not_equal:s,bound:Zt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(l?l.$$.context:[])),callbacks:Zt(),dirty:o,skip_bound:!1,root:n.target||l.$$.root};c&&c(a.root);let h=!1;if(a.ctx=t?t(e,n.props||{},(u,m,...f)=>{const d=f.length?f[0]:m;return a.ctx&&s(a.ctx[u],a.ctx[u]=d)&&(!a.skip_bound&&a.bound[u]&&a.bound[u](d),h&&Ue(e,u)),m}):[],a.update(),h=!0,J(a.before_update),a.fragment=i?i(a.ctx):!1,n.target){if(n.hydrate){const u=Pe(n.target);a.fragment&&a.fragment.l(u),u.forEach(ft)}else a.fragment&&a.fragment.c();n.intro&&Vt(e.$$.fragment),Wt(e,n.target,n.anchor,n.customElement),xe()}at(l)}class Et{$destroy(){Xt(this,1),this.$destroy=w}$on(n,t){if(!ht(t))return w;const i=this.$$.callbacks[n]||(this.$$.callbacks[n]=[]);return i.push(t),()=>{const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}$set(n){this.$$set&&!Se(n)&&(this.$$.skip_bound=!0,this.$$set(n),this.$$.skip_bound=!1)}}function Ne(e){let n,t,i,s,r,c;return{c(){n=j("button"),S(n,"id",t=e[1].id),S(n,"class",i=_t(e[1].class)+" svelte-1ighmgr"),S(n,"style",s=e[1].style)},m(o,l){Qt(o,n,l),n.innerHTML=e[0],r||(c=we(n,"click",e[5]),r=!0)},p(o,[l]){l&2&&t!==(t=o[1].id)&&S(n,"id",t),l&2&&i!==(i=_t(o[1].class)+" svelte-1ighmgr")&&S(n,"class",i),l&2&&s!==(s=o[1].style)&&S(n,"style",s)},i:w,o:w,d(o){o&&ft(n),r=!1,c()}}}function ze(e,n,t){let{name:i}=n,{fill:s="white"}=n,{stroke:r="white"}=n,o={chart:`<svg x="0px" y="0px" stroke="white" fill="white" stroke-width="5" viewBox="0 0 100 100">
            <circle style="fill-opacity: 0; opacity: 1;" cx="50" cy="50" r="48" />
            <path fill="none" stroke="white" stroke-linecap="round" d="M 25, 75 L 42 40 L 58 60 L 75 25 "/>
        </svg>`,edit:`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
        </svg>`,happy:`<svg stroke="${r}" stroke-width="3" fill-opacity="0" viewBox="0 0 50 50" xml:space="preserve">
            <circle cx="25" cy="25" r="22" />
            <circle cx="18" cy="20" r="3" />
            <circle cx="32" cy="20" r="3" />
            <path d="M 15,33 Q 25,40 35,33"/>
        </svg>`,menu:`<svg viewBox="0 0 24 24" fill="none" stroke="${r}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
            <line x1="3" y1="4" x2="21" y2="4"></line>
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="20" x2="21" y2="20"></line>
        </svg>`,more:`<svg viewBox="0 0 100 100" fill="${s}">
            <circle cx="15" cy="50" r="10" />
            <circle cx="50" cy="50" r="10" />
            <circle cx="85" cy="50" r="10" />
        </svg>`,plus:`<svg stroke="${r}" fill="white" x="0" y="0" viewBox="0 0 100 100" stroke-width="10" stroke-linecap="round">
            <line x1="50" y1="5" x2="50" y2="95" />
            <line x1="5" y1="50" x2="95" y2="50" />
        </svg>`,profile:`<svg x="0px" y="0px" stroke="${r}" fill="white" viewBox="0 0 54 54" xml:space="preserve">
            <circle style="stroke-width: 3; fill-opacity: 0; opacity: 1;" cx="26.5" cy="26.5" r="24" />
            <circle style="stroke-width: 3; fill-opacity: 0; opacity: 1;" cx="26.5" cy="20" r="10" />
            <path fill="none" stroke="white" stroke-width="3" d="M 8,42 Q 12,28 20,28 M 45,42 Q 41,28 33,28 "/>
        </svg>`,retry:`<svg stroke="${r}" stroke-width="3" fill-opacity="0" viewBox="0 0 50 50">
            <path d="M 42,32 A 20,20,0,1,1,42,18"/>
            <path fill="white" fill-opacity="1" d="M 44,22 L 34,17 L 45,12  Z"/>
        </svg>`,sad:`<svg stroke="${r}" stroke-width="3" fill-opacity="0" viewBox="0 0 50 50" xml:space="preserve">
            <circle cx="25" cy="25" r="22" />
            <circle cx="18" cy="20" r="3" />
            <circle cx="32" cy="20" r="3" />
            <path d="M 15,35 Q 25,28 35,35"/>
        </svg>`,settings:`<svg x="0px" y="0px" stroke="${r}" fill="white" viewBox="0 0 54 54" xml:space="preserve">
        <path d="M51.22,21h-5.052c-0.812,0-1.481-0.447-1.792-1.197s-0.153-1.54,0.42-2.114l3.572-3.571
            c0.525-0.525,0.814-1.224,0.814-1.966c0-0.743-0.289-1.441-0.814-1.967l-4.553-4.553c-1.05-1.05-2.881-1.052-3.933,0l-3.571,3.571
            c-0.574,0.573-1.366,0.733-2.114,0.421C33.447,9.313,33,8.644,33,7.832V2.78C33,1.247,31.753,0,30.22,0H23.78
            C22.247,0,21,1.247,21,2.78v5.052c0,0.812-0.447,1.481-1.197,1.792c-0.748,0.313-1.54,0.152-2.114-0.421l-3.571-3.571
            c-1.052-1.052-2.883-1.05-3.933,0l-4.553,4.553c-0.525,0.525-0.814,1.224-0.814,1.967c0,0.742,0.289,1.44,0.814,1.966l3.572,3.571
            c0.573,0.574,0.73,1.364,0.42,2.114S8.644,21,7.832,21H2.78C1.247,21,0,22.247,0,23.78v6.439C0,31.753,1.247,33,2.78,33h5.052
            c0.812,0,1.481,0.447,1.792,1.197s0.153,1.54-0.42,2.114l-3.572,3.571c-0.525,0.525-0.814,1.224-0.814,1.966
            c0,0.743,0.289,1.441,0.814,1.967l4.553,4.553c1.051,1.051,2.881,1.053,3.933,0l3.571-3.572c0.574-0.573,1.363-0.731,2.114-0.42
            c0.75,0.311,1.197,0.98,1.197,1.792v5.052c0,1.533,1.247,2.78,2.78,2.78h6.439c1.533,0,2.78-1.247,2.78-2.78v-5.052
            c0-0.812,0.447-1.481,1.197-1.792c0.751-0.312,1.54-0.153,2.114,0.42l3.571,3.572c1.052,1.052,2.883,1.05,3.933,0l4.553-4.553
            c0.525-0.525,0.814-1.224,0.814-1.967c0-0.742-0.289-1.44-0.814-1.966l-3.572-3.571c-0.573-0.574-0.73-1.364-0.42-2.114
            S45.356,33,46.168,33h5.052c1.533,0,2.78-1.247,2.78-2.78V23.78C54,22.247,52.753,21,51.22,21z M52,30.22
            C52,30.65,51.65,31,51.22,31h-5.052c-1.624,0-3.019,0.932-3.64,2.432c-0.622,1.5-0.295,3.146,0.854,4.294l3.572,3.571
            c0.305,0.305,0.305,0.8,0,1.104l-4.553,4.553c-0.304,0.304-0.799,0.306-1.104,0l-3.571-3.572c-1.149-1.149-2.794-1.474-4.294-0.854
            c-1.5,0.621-2.432,2.016-2.432,3.64v5.052C31,51.65,30.65,52,30.22,52H23.78C23.35,52,23,51.65,23,51.22v-5.052
            c0-1.624-0.932-3.019-2.432-3.64c-0.503-0.209-1.021-0.311-1.533-0.311c-1.014,0-1.997,0.4-2.761,1.164l-3.571,3.572
            c-0.306,0.306-0.801,0.304-1.104,0l-4.553-4.553c-0.305-0.305-0.305-0.8,0-1.104l3.572-3.571c1.148-1.148,1.476-2.794,0.854-4.294
            C10.851,31.932,9.456,31,7.832,31H2.78C2.35,31,2,30.65,2,30.22V23.78C2,23.35,2.35,23,2.78,23h5.052
            c1.624,0,3.019-0.932,3.64-2.432c0.622-1.5,0.295-3.146-0.854-4.294l-3.572-3.571c-0.305-0.305-0.305-0.8,0-1.104l4.553-4.553
            c0.304-0.305,0.799-0.305,1.104,0l3.571,3.571c1.147,1.147,2.792,1.476,4.294,0.854C22.068,10.851,23,9.456,23,7.832V2.78
            C23,2.35,23.35,2,23.78,2h6.439C30.65,2,31,2.35,31,2.78v5.052c0,1.624,0.932,3.019,2.432,3.64
            c1.502,0.622,3.146,0.294,4.294-0.854l3.571-3.571c0.306-0.305,0.801-0.305,1.104,0l4.553,4.553c0.305,0.305,0.305,0.8,0,1.104
            l-3.572,3.571c-1.148,1.148-1.476,2.794-0.854,4.294c0.621,1.5,2.016,2.432,3.64,2.432h5.052C51.65,23,52,23.35,52,23.78V30.22z"/>
            <path d="M27,18c-4.963,0-9,4.037-9,9s4.037,9,9,9s9-4.037,9-9S31.963,18,27,18z M27,34c-3.859,0-7-3.141-7-7s3.141-7,7-7s7,3.141,7,7S30.859,34,27,34z"/>
        </svg>`,x:`<svg viewBox="0 0 24 24" stroke="${r}">
            <path d="M 2 2 L 22 22 M 22 2 L 2 22" stroke-width="2" />
        </svg>`}[i];function l(a){ge.call(this,e,a)}return e.$$set=a=>{t(1,n=lt(lt({},n),xt(a))),"name"in a&&t(2,i=a.name),"fill"in a&&t(3,s=a.fill),"stroke"in a&&t(4,r=a.stroke)},n=xt(n),[o,n,i,s,r,l]}class be extends Et{constructor(n){super(),St(this,n,ze,Ne,Rt,{name:2,fill:3,stroke:4})}}const je=[1,1,1,1],qn=[.5,.5,.5,1],He=[1,1,0,1],Ye=[0,1,0,1],Qe=[0,0,1,1],$e=[1,.5,0,1],Ve=[1,0,0,1],Ge=[0,0,0,1],te=[je,Ye,He,Qe,$e,Ve];function ee(e){return(e<0||e>=te.length)&&console.error("Invalid face: "+e),te[e]}function We(e){const n=e.layers,t=e.gl,i=e.perspectiveMatrix;let s=wt(n,1.01,.02),r=wt(n,1,0),c=wt(n,1.5,.02);const o=Array(T(n));for(let l=0;l<T(n);l++){let a={positionBuffer:t.createBuffer(),noGapPositionBuffer:t.createBuffer(),hintPositionBuffer:t.createBuffer(),indexBuffer:t.createBuffer(),cart2d:[],positions:null},h=new Float32Array(12),u=new Float32Array(12),m=new Float32Array(12);for(let y=0;y<12;y++){let g=l*12+y;h[y]=s[g],u[y]=r[g],m[y]=c[g]}t.bindBuffer(t.ARRAY_BUFFER,a.positionBuffer),t.bufferData(t.ARRAY_BUFFER,h,t.STATIC_DRAW),a.positions=h,t.bindBuffer(t.ARRAY_BUFFER,a.noGapPositionBuffer),t.bufferData(t.ARRAY_BUFFER,u,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,a.hintPositionBuffer),t.bufferData(t.ARRAY_BUFFER,m,t.STATIC_DRAW);const f=Array(16);dt(f,0,i,[u[0],u[1],u[2],1]),dt(f,4,i,[u[3],u[4],u[5],1]),dt(f,8,i,[u[6],u[7],u[8],1]),dt(f,12,i,[u[9],u[10],u[11],1]),a.cart2d=[f[0]/f[3],f[1]/f[3],f[4]/f[7],f[5]/f[7],f[8]/f[11],f[9]/f[11],f[12]/f[15],f[13]/f[15]];const d=[0,1,2,0,2,3];t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,a.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),t.STATIC_DRAW),o[l]=a}return o}function dt(e,n,t,i){let s=i[0],r=i[1],c=i[2],o=i[3];e[n+0]=s*t[0]+r*t[4]+c*t[8]+o*t[12],e[n+1]=s*t[1]+r*t[5]+c*t[9]+o*t[13],e[n+2]=s*t[2]+r*t[6]+c*t[10]+o*t[14],e[n+3]=s*t[3]+r*t[7]+c*t[11]+o*t[15]}const ke=12,Xe=4,et=3;function wt(e,n,t){const i=p(e)*ke,s=Array(6*i);return qe(s,0*i,e,1,n,t),Ze(s,1*i,e,0,n,t),Je(s,2*i,e,1,-n,t),tn(s,3*i,e,0,-n,t),en(s,4*i,e,2,-n,t),nn(s,5*i,e,2,n,t),s}function qe(e,n,t,i,s,r){if(ot(t)){let l=Array(p(t)),a=0;for(let h=0;h<t;h++)for(let u=0;u<t;u++){const m=-1+1/t+u*2/t,f=-1+1/t+h*2/t;l[a]=[m,f,s],a++}E(e,n,t,l,i,r);return}let c=Array(p(t)),o=0;for(let l=-b(t);l<=b(t);l++)for(let a=-b(t);a<=b(t);a++)c[o]=[2*a/t,2*l/t,s],o++;E(e,n,t,c,i,r)}function Ze(e,n,t,i,s,r){if(ot(t)){let l=Array(p(t)),a=0;for(let h=0;h<t;h++)for(let u=t-1;u>=0;u--){const m=-1+1/t+h*2/t,f=-1+1/t+u*2/t;l[a]=[m,f,s],a++}E(e,n,t,l,i,r);return}let c=Array(p(t)),o=0;for(let l=-b(t);l<=b(t);l++)for(let a=b(t);a>=-b(t);a--)c[o]=[2*l/t,2*a/t,s],o++;E(e,n,t,c,i,r)}function Je(e,n,t,i,s,r){if(ot(t)){let l=Array(p(t)),a=0;for(let h=0;h<t;h++)for(let u=t-1;u>=0;u--){const m=-1+1/t+u*2/t,f=-1+1/t+h*2/t;l[a]=[m,f,s],a++}E(e,n,t,l,i,r);return}let c=Array(p(t)),o=0;for(let l=-b(t);l<=b(t);l++)for(let a=b(t);a>=-b(t);a--)c[o]=[2*a/t,2*l/t,s],o++;E(e,n,t,c,i,r)}function tn(e,n,t,i,s,r){if(ot(t)){let l=Array(p(t)),a=0;for(let h=0;h<t;h++)for(let u=0;u<t;u++){const m=-1+1/t+h*2/t,f=-1+1/t+u*2/t;l[a]=[m,f,s],a++}E(e,n,t,l,i,r);return}let c=Array(p(t)),o=0;for(let l=-b(t);l<=b(t);l++)for(let a=-b(t);a<=b(t);a++)c[o]=[2*l/t,2*a/t,s],o++;E(e,n,t,c,i,r)}function en(e,n,t,i,s,r){if(ot(t)){let l=Array(p(t)),a=0;for(let h=0;h<t;h++)for(let u=t-1;u>=0;u--){const m=-1+1/t+u*2/t,f=-1+1/t+h*2/t;l[a]=[m,f,s],a++}E(e,n,t,l,i,r);return}let c=Array(p(t)),o=0;for(let l=-b(t);l<=b(t);l++)for(let a=b(t);a>=-b(t);a--)c[o]=[2*a/t,2*l/t,s],o++;E(e,n,t,c,i,r)}function nn(e,n,t,i,s,r){if(ot(t)){let l=Array(p(t)),a=0;for(let h=t-1;h>=0;h--)for(let u=t-1;u>=0;u--){const m=-1+1/t+u*2/t,f=-1+1/t+h*2/t;l[a]=[m,f,s],a++}E(e,n,t,l,i,r);return}let c=Array(p(t)),o=0;for(let l=b(t);l>=-b(t);l--)for(let a=b(t);a>=-b(t);a--)c[o]=[2*a/t,2*l/t,s],o++;E(e,n,t,c,i,r)}function E(e,n,t,i,s,r){for(let c=0;c<p(t);c++){const o=i[c];sn(e,n+c*ke,t,o[0],o[1],o[2],s,r)}}function sn(e,n,t,i,s,r,c,o){const l=1/t-o,a=[[i-l,s-l,r],[i+l,s-l,r],[i+l,s+l,r],[i-l,s+l,r]];for(let h=0;h<Xe;h++){const u=a[h];e[n+h*et]=u[(c+0)%et],e[n+h*et+1]=u[(c+1)%et],e[n+h*et+2]=u[(c+2)%et]}}function pt(e){return Math.floor(Math.random()*e)}function rn(e){let n=e.length;for(;n!=0;){let t=pt(n);n--;let i=e[t];e[t]=e[n],e[n]=i}return e}const H=0,Y=1,Q=2,$=3,V=4,G=5,on=[[H,$,V],[H,G,$],[H,V,Y],[H,Y,G],[Q,Y,V],[Q,G,Y],[Q,V,$],[Q,$,G]],cn=[[H,$],[H,V],[H,G],[H,Y],[Y,V],[Y,G],[Q,Y],[Q,V],[Q,G],[Q,$],[$,V],[$,G]];function an(e){let n=ne(12,2),t=ne(8,3),i=Pt(8),s=Pt(12);for(;ie(i)!==ie(s);)i=Pt(8);const r=Array(54);for(let x=0;x<6;x++){const M=e.center(x);r[M]=x}let c=e.corners(0,0),o=e.corners(1,0),l=e.corners(2,0),a=e.corners(3,0),h=e.corners(4,0),u=e.corners(5,0);const m=(x,M,W,C,D,B,F,I,K)=>{const A=(P,U)=>on[i[P]][(t[P]+U)%3];r[x.topLeft]=A(M,B),r[x.topRight]=A(W,F),r[x.bottomLeft]=A(C,I),r[x.bottomRight]=A(D,K)};m(c,0,1,2,3,0,0,0,0),m(o,2,3,4,5,2,1,1,2),m(l,4,5,6,7,0,0,0,0),m(a,6,7,0,1,2,1,1,2),m(h,0,2,6,4,2,1,1,2),m(u,3,1,5,7,2,1,1,2);let f=e.edges(0,0,0),d=e.edges(1,0,0),y=e.edges(2,0,0),g=e.edges(3,0,0),v=e.edges(4,0,0),R=e.edges(5,0,0);const k=(x,M,W,C,D,B,F,I,K)=>{const A=(P,U)=>cn[s[P]][(n[P]+U)%2];r[x.top]=A(M,B),r[x.left]=A(W,F),r[x.right]=A(C,I),r[x.bottom]=A(D,K)};return k(f,0,1,2,3,0,0,0,0),k(d,3,4,5,6,1,0,0,1),k(y,6,7,8,9,0,0,0,0),k(g,9,10,11,0,1,0,0,1),k(v,1,10,4,7,1,1,1,1),k(R,2,5,11,8,1,1,1,1),r}function ne(e,n){const t=Array(e);for(let i=0;i<e;i++)t[i]=pt(n);for(;!ln(t,n);){const i=pt(e);t[i]=pt(n)}return t}function ln(e,n){let t=0;for(let i=0;i<e.length;i++)t+=e[i];return t%n===0}function Pt(e){const n=Array(e);for(let t=0;t<e;t++)n[t]=t;return rn(n),n}function ie(e){const n=[...e];let t=!1;for(;;)if(n[0]===0){const i=n.findIndex((s,r)=>s!==r);if(i===-1)return t;n[0]=n[i],n[i]=0,t=!t}else{const i=n[0];n[0]=n[i],n[i]=i,t=!t}}let z;function Lt(e,n){const t=[n[0],n[1],n[2],n[3],n[0],n[1],n[2],n[3],n[0],n[1],n[2],n[3],n[0],n[1],n[2],n[3]];z.bindBuffer(z.ARRAY_BUFFER,e.buffer),z.bufferData(z.ARRAY_BUFFER,new Float32Array(t),z.STATIC_DRAW)}function p(e){return e*e}function b(e){return Math.floor(e/2)}function ot(e){return e%2==0}function T(e){return e*e*6}class un{stickers;underStickers;layers;affectedStickers;disableTurn;clockwise;animationQueue;gl;perspectiveMatrix;buffers;constructor(n,t){z=n,this.animationQueue=[],this.gl=n,this.perspectiveMatrix=t}setColors(n){for(let t=0;t<T(this.layers);t++)Lt(this.stickers[t],n[t])}solve(){const n=Array(T(this.layers));for(let t=0;t<T(this.layers);t++){const i=this.stickerToFace(t);this.stickers[t].face=i,n[t]=ee(i)}this.setColors(n)}scramble(){if(this.layers===3){this.scramble3x3();return}this.naiveScramble()}scramble3x3(){const n=an(this);this.setCubeState(n)}naiveScramble(){let n=p(this.layers)*10;for(let t=0;t<n;t++){let i=Math.floor(Math.random()*3),s=Math.floor(Math.random()*this.layers),r=Math.floor(Math.random()*1)==0;this.matchTurn(i,s,r)}}setNumOfLayers(n){this.layers=n,this.stickers=Array(T(n)),this.underStickers=Array(T(n));for(let t=0;t<T(n);t++){const i=this.stickerToFace(t);this.stickers[t]={face:i,buffer:z.createBuffer()},this.underStickers[t]={face:i,buffer:z.createBuffer()},Lt(this.underStickers[t],Ge)}this.affectedStickers=Array(T(n)).fill(!1),this.buffers=We(this),this.solve()}getCubeState(){return this.stickers.map(n=>n.face)}setCubeState(n){for(let t=0;t<T(this.layers);t++){const i=ee(n[t]);this.stickers[t].face=n[t],Lt(this.stickers[t],i)}}resetAffectedStickers(){const n=Array(T(this.layers));this.affectedStickers=n.fill(this.layers===1)}pushAnimation(n,t,i){let s=t?-1:1,r=[0,0,0];r[n]=s,this.animationQueue.push({axis:r,stickers:i,stickersToAnimate:this.affectedStickers})}turn(n,t,i){this.resetAffectedStickers(),this.pushAnimation(n,i,[...this.stickers]),this.matchTurn(n,t,i)}sliceTurn(n,t){const i=Array(T(this.layers));this.affectedStickers=i.fill(!1),this.pushAnimation(n,t,[...this.stickers]);for(let s=1;s<this.layers-1;s++)this.matchTurn(n,s,t)}wideTurn(n,t,i){this.resetAffectedStickers(),this.pushAnimation(n,i,[...this.stickers]),this.matchTurn(n,t,i);for(let s=1;s<this.layers-1;s++)this.matchTurn(n,s,i)}cubeRotate(n,t){this.resetAffectedStickers(),this.pushAnimation(n,t,[...this.stickers]);for(let i=0;i<this.layers;i++)this.matchTurn(n,i,t)}matchTurn(n,t,i){n==0?(this.turnXAxis(t,i),t==0?this.turnOuter(5,i):t==this.layers-1&&this.turnOuter(4,!i)):n==1?(this.turnYAxis(t,i),t==0?this.turnOuter(0,i):t==this.layers-1&&this.turnOuter(2,!i)):n==2?(this.turnZAxis(t,i),t==0?this.turnOuter(1,i):t==this.layers-1&&this.turnOuter(3,!i)):console.error(`Axis ${n} not recognized`)}turnXAxis(n,t){for(let i=1;i<=this.layers;i++)this.cycle(t,0*p(this.layers)+p(this.layers)-i-n*this.layers,3*p(this.layers)+p(this.layers)-i-n*this.layers,2*p(this.layers)+p(this.layers)-i-n*this.layers,1*p(this.layers)+p(this.layers)-i-n*this.layers)}turnYAxis(n,t){for(let i=0;i<this.layers;i++)this.cycle(t,1*p(this.layers)+i*this.layers+n,4*p(this.layers)+i*this.layers+n,3*p(this.layers)+(this.layers-i-1)*this.layers+(this.layers-1)-n,5*p(this.layers)+i*this.layers+n)}turnZAxis(n,t){for(let i=0;i<this.layers;i++)this.cycle(t,0*p(this.layers)+(i+1)*this.layers-1-n,5*p(this.layers)+i+this.layers*n,2*p(this.layers)+(this.layers-i-1)*this.layers+n,4*p(this.layers)+p(this.layers)-(i+1)-n*this.layers)}turnOuter(n,t){if(this.layers%2!=0){let i=this.center(n);this.affectedStickers[i]=!0}for(let i=0;i<Math.floor(this.layers/2);i++){const{topLeft:s,topRight:r,bottomLeft:c,bottomRight:o}=this.corners(n,i);this.cycle(t,s,r,o,c);let l=this.layers-2*(i+1);for(let a=0;a<l;a++){const{top:h,left:u,bottom:m,right:f}=this.edges(n,i,a);this.cycle(t,h,f,m,u)}}}cycle(n,t,i,s,r){this.affectedStickers[t]=!0,this.affectedStickers[i]=!0,this.affectedStickers[s]=!0,this.affectedStickers[r]=!0,n?this.cycleHelper(t,i,s,r):this.cycleHelper(r,s,i,t)}cycleHelper(n,t,i,s){let r=this.stickers[s];this.stickers[s]=this.stickers[i],this.stickers[i]=this.stickers[t],this.stickers[t]=this.stickers[n],this.stickers[n]=r}matchKeyToTurn(n){if(!this.disableTurn&&!n.ctrlKey)return this.matchKeyCodeToTurn(n.code)}matchKeyCodeToTurn(n){switch(n){case"KeyN":return this.cubeRotate(0,!0),{notation:"x",rotate:!0};case"KeyB":return this.cubeRotate(0,!1),{notation:"x'",rotate:!0};case"Semicolon":return this.cubeRotate(1,!0),{notation:"y",rotate:!0};case"KeyA":return this.cubeRotate(1,!1),{notation:"y'",rotate:!0};case"KeyP":return this.cubeRotate(2,!0),{notation:"z",rotate:!0};case"KeyQ":return this.cubeRotate(2,!1),{notation:"z'",rotate:!0};case"KeyJ":return this.turn(1,0,!0),{notation:"U",turn:!0};case"KeyF":return this.turn(1,0,!1),{notation:"U'",turn:!0};case"KeyS":return this.turn(1,this.layers-1,!1),{notation:"D",turn:!0};case"KeyL":return this.turn(1,this.layers-1,!0),{notation:"D'",turn:!0};case"KeyH":return this.turn(2,0,!0),{notation:"F",turn:!0};case"KeyG":return this.turn(2,0,!1),{notation:"F'",turn:!0};case"KeyW":return this.turn(2,this.layers-1,!1),{notation:"B",turn:!0};case"KeyO":return this.turn(2,this.layers-1,!0),{notation:"B'",turn:!0};case"KeyD":return this.turn(0,this.layers-1,!1),{notation:"L",turn:!0};case"KeyE":return this.turn(0,this.layers-1,!0),{notation:"L'",turn:!0};case"KeyI":return this.turn(0,0,!0),{notation:"R",turn:!0};case"KeyK":return this.turn(0,0,!1),{notation:"R'",turn:!0};case"BracketLeft":return this.sliceTurn(0,!1),{notation:"M",turn:!0};case"Quote":return this.sliceTurn(0,!0),{notation:"M'",turn:!0};case"KeyC":return this.sliceTurn(1,!1),{notation:"E",turn:!0};case"Comma":return this.sliceTurn(1,!0),{notation:"E'",turn:!0};case"KeyY":return this.sliceTurn(2,!0),{notation:"S",turn:!0};case"KeyT":return this.sliceTurn(2,!1),{notation:"S'",turn:!0};case"KeyU":return this.wideTurn(0,0,!0),{notation:"r",turn:!0};case"KeyM":return this.wideTurn(0,0,!1),{notation:"r'",turn:!0};case"KeyV":return this.wideTurn(0,this.layers-1,!1),{notation:"l",turn:!0};case"KeyR":return this.wideTurn(0,this.layers-1,!0),{notation:"l'",turn:!0}}}performMove(n,t){switch(n){case"x":this.cubeRotate(0,t);break;case"x'":this.cubeRotate(0,!t);break;case"x2":case"x2'":this.cubeRotate(0,t),this.cubeRotate(0,t);break;case"y":this.cubeRotate(1,t);break;case"y'":this.cubeRotate(1,!t);break;case"y2":case"y2'":this.cubeRotate(1,t),this.cubeRotate(1,t);break;case"z":this.cubeRotate(2,t);break;case"z'":this.cubeRotate(2,!t);break;case"z2":case"z2'":this.cubeRotate(2,t),this.cubeRotate(2,t);break;case"U":this.turn(1,0,t);break;case"U'":this.turn(1,0,!t);break;case"U2":case"U2'":this.turn(1,0,t),this.turn(1,0,t);break;case"u":this.wideTurn(1,0,t);break;case"u'":this.wideTurn(1,0,!t);break;case"u2":case"u2'":this.wideTurn(1,0,t),this.wideTurn(1,0,t);break;case"D":this.turn(1,this.layers-1,!t);break;case"D'":this.turn(1,this.layers-1,t);break;case"D2":case"D2'":this.turn(1,this.layers-1,t),this.turn(1,this.layers-1,t);break;case"d":this.wideTurn(1,this.layers-1,!t);break;case"d'":this.wideTurn(1,this.layers-1,t);break;case"d2":case"d2'":this.wideTurn(1,this.layers-1,t),this.wideTurn(1,this.layers-1,t);break;case"F":this.turn(2,0,t);break;case"F'":this.turn(2,0,!t);break;case"F2":case"F2'":this.turn(2,0,t),this.turn(2,0,t);break;case"f":this.wideTurn(2,0,t);break;case"f'":this.wideTurn(2,0,!t);break;case"f2":case"f2'":this.wideTurn(2,0,t),this.wideTurn(2,0,t);break;case"B":this.turn(2,this.layers-1,!t);break;case"B'":this.turn(2,this.layers-1,t);break;case"B2":case"B2'":this.turn(2,this.layers-1,t),this.turn(2,this.layers-1,t);break;case"b":this.wideTurn(2,this.layers-1,!t);break;case"b'":this.wideTurn(2,this.layers-1,t);break;case"b2":case"b2'":this.wideTurn(2,this.layers-1,t),this.wideTurn(2,this.layers-1,t);break;case"L":this.turn(0,this.layers-1,!t);break;case"L'":this.turn(0,this.layers-1,t);break;case"L2":case"L2'":this.turn(0,this.layers-1,t),this.turn(0,this.layers-1,t);break;case"l":this.wideTurn(0,this.layers-1,!t);break;case"l'":this.wideTurn(0,this.layers-1,t);break;case"l2":case"l2'":this.wideTurn(0,this.layers-1,t),this.wideTurn(0,this.layers-1,t);break;case"R":this.turn(0,0,t);break;case"R'":this.turn(0,0,!t);break;case"R2":case"R2'":this.turn(0,0,t),this.turn(0,0,t);break;case"r":this.wideTurn(0,0,t);break;case"r'":this.wideTurn(0,0,!t);break;case"r2":case"r2'":this.wideTurn(0,0,t),this.wideTurn(0,0,t);break;case"M":this.turn(0,1,!t);break;case"M'":this.turn(0,1,t);break;case"M2":case"M2'":this.sliceTurn(0,t),this.sliceTurn(0,t);break;case"E":this.sliceTurn(1,!t);break;case"E'":this.sliceTurn(1,t);break;case"E2":case"E2'":this.sliceTurn(1,t),this.sliceTurn(1,t);break;case"S":this.sliceTurn(2,t);break;case"S'":this.sliceTurn(2,!t);break;case"S2":case"S2'":this.sliceTurn(2,t);default:throw new Error("Invalid turn in algorithm: "+n)}}performAlg(n){if(!n)return;let t=n.split(" ");for(let i=0;i<t.length;i++)this.performMove(t[i],!0);this.animationQueue=[]}performAlgReverse(n){if(!n)return;let t=n.split(" ");for(let i=t.length-1;i>=0;i--)this.performMove(t[i],!1);this.animationQueue=[]}stickerIsOnFace(n,t){return t*p(this.layers)<=n&&n<(t+1)*p(this.layers)}stickerToFace(n){return Math.floor(n/p(this.layers))}center(n){return n*p(this.layers)+Math.floor(p(this.layers)/2)}corners(n,t){const i=n*p(this.layers);return{topLeft:i+(this.layers+1)*t,topRight:i+(this.layers-1)*(this.layers-t),bottomRight:i+(this.layers+1)*(this.layers-t-1),bottomLeft:i+(this.layers-1)*(t+1)}}edges(n,t,i){const s=this.corners(n,t);let r=this.layers-2*(t+1);return{top:s.topLeft+this.layers*(i+1),left:s.topLeft+(r-i),right:s.topRight+i+1,bottom:s.bottomLeft+this.layers*(r-i)}}}function se(e,n){return e/n*2-1}function re(e,n){return 1-e/n*2}function Ot(e,n,t,i){return e<t?(i-n)/(t-e):(n-i)/(e-t)}function nt(e,n,t,i,s,r){return Math.abs(.5*(e*(i-r)+t*(r-n)+s*(n-i)))}function hn(e,n){return e.layers-1-n%e.layers}function Ct(e,n){return e.layers-1-Math.floor(n/e.layers)}function fn(e,n){return n%e.layers}function Dt(e,n){return e.layers-1-Math.floor((n-p(e.layers))/e.layers)}class dn{numOfPointerMoves;xOnDown;yOnDown;xOnMove;yOnMove;stickerOnDown;cart2dOnDown;onPointerDown(n,t,i,s){const r=s.buffers;this.numOfPointerMoves=0;const c=se(n,i.clientWidth),o=re(t,i.clientHeight);this.xOnDown=c,this.yOnDown=o,[this.stickerOnDown,this.cart2dOnDown]=this._coordinatesToSticker(c,o,s,r);function l(y,g,v){return{x:r[y].cart2d[g],y:r[y].cart2d[v]}}if(this.stickerOnDown!==-1)return;const a=l(0,0,1),h=l(s.layers*(s.layers-1),6,7),u=l(s.layers-1,2,3),m=l(p(s.layers)-1,4,5),f=l(s.layers*(s.layers+1)-1,0,1),d=l(p(s.layers)*2-1,2,3);o>a.y&&c>a.x&&c<h.x?s.cubeRotate(0,!0):c<a.x&&o>u.y&&o<a.y?s.cubeRotate(2,!1):c>h.x&&o>m.y&&o<h.y?s.cubeRotate(2,!0):c<f.x&&o>f.y&&o<u.y?s.cubeRotate(1,!0):c>d.x&&o>d.y&&o<m.y?s.cubeRotate(1,!1):o<f.y&&c>f.x&&c<d.x&&s.cubeRotate(0,!1)}onPointerMove(n,t){this.numOfPointerMoves++,this.xOnMove=n,this.yOnMove=t}onPointerUp(n,t){if(this.numOfPointerMoves<2)return;let i,s;if(this.stickerOnDown!==-1&&(i=Ot(this.cart2dOnDown[0],this.cart2dOnDown[1],this.cart2dOnDown[4],this.cart2dOnDown[5]),s=Ot(this.cart2dOnDown[2],this.cart2dOnDown[3],this.cart2dOnDown[6],this.cart2dOnDown[7]),i<0)){const l=i;i=s,s=l}const r=se(this.xOnMove,n.clientWidth),c=re(this.yOnMove,n.clientHeight),o=Ot(r,c,this.xOnDown,this.yOnDown);t.stickerIsOnFace(this.stickerOnDown,0)?r===this.xOnDown?t.turn(0,Ct(t,this.stickerOnDown),c>this.yOnDown):o>i?t.turn(0,Ct(t,this.stickerOnDown),r>this.xOnDown):o<s?t.turn(0,Ct(t,this.stickerOnDown),r<this.xOnDown):t.turn(2,hn(t,this.stickerOnDown),r>this.xOnDown):t.stickerIsOnFace(this.stickerOnDown,1)&&(r===this.xOnDown?t.turn(0,Dt(t,this.stickerOnDown),c>this.yOnDown):o>i?t.turn(0,Dt(t,this.stickerOnDown),r>this.xOnDown):o<s?t.turn(0,Dt(t,this.stickerOnDown),r<this.xOnDown):t.turn(1,fn(t,this.stickerOnDown),r<this.xOnDown))}_coordinatesToSticker(n,t,i,s){const r=c=>{if(!s[c].cart2d){console.error("cart2d is undefined");return}const o=s[c].cart2d,l=nt(o[0],o[1],o[2],o[3],o[4],o[5])+nt(o[0],o[1],o[4],o[5],o[6],o[7]),a=nt(n,t,o[0],o[1],o[2],o[3])+nt(n,t,o[2],o[3],o[4],o[5])+nt(n,t,o[4],o[5],o[6],o[7])+nt(n,t,o[6],o[7],o[0],o[1]),h=1e-5;if(Math.abs(l-a)<h)return[c,o]};for(let c=0;c<2*p(i.layers);c++){const o=r(c);if(o)return o}return[-1,void 0]}}function gt(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function yn(e,n,t,i,s){const r=1/Math.tan(n/2);if(e[0]=r/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,s!=null&&s!==1/0){const c=1/(i-s);e[10]=(s+i)*c,e[14]=2*s*i*c}else e[10]=-1,e[14]=-2*i;return e}function Tt(e,n,t,i){let s=i[0],r=i[1],c=i[2],o=1/Math.hypot(s,r,c);s*=o,r*=o,c*=o;let l=Math.sin(t),a=Math.cos(t),h=1-a,u=n[0],m=n[1],f=n[2],d=n[3],y=n[4],g=n[5],v=n[6],R=n[7],k=n[8],x=n[9],M=n[10],W=n[11],C=s*s*h+a,D=r*s*h+c*l,B=c*s*h-r*l,F=s*r*h-c*l,I=r*r*h+a,K=c*r*h+s*l,A=s*c*h+r*l,P=r*c*h-s*l,U=c*c*h+a;return e[0]=u*C+y*D+k*B,e[1]=m*C+g*D+x*B,e[2]=f*C+v*D+M*B,e[3]=d*C+R*D+W*B,e[4]=u*F+y*I+k*K,e[5]=m*F+g*I+x*K,e[6]=f*F+v*I+M*K,e[7]=d*F+R*I+W*K,e[8]=u*A+y*P+k*U,e[9]=m*A+g*P+x*U,e[10]=f*A+v*P+M*U,e[11]=d*A+R*P+W*U,n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e}function mn(e,n){let t=n[0],i=n[1],s=n[2];return e[12]+=e[0]*t+e[4]*i+e[7]*s,e[13]+=e[1]*t+e[5]*i+e[8]*s,e[14]+=e[2]*t+e[5]*i+e[9]*s,e[15]+=e[3]*t+e[6]*i+e[10]*s,e}function oe(){let e;return n=>(e||(e=n()),e)}const pn=100,gn=15;class xn{position;_velocity;_acceleration;target;constructor(){this.position=0,this._velocity=200,this._acceleration=0,this.target=0}update(n){const t=-pn*(this.position-this.target),i=-gn*this._velocity;this._acceleration=t+i,this._velocity+=this._acceleration*n,this.position+=this._velocity*n}}let L=_n(),_=vn(L),N=bn(_);function _n(){const e=document.createElement("canvas");return e.style.position="fixed",e.style.display="block",e.style.top="0",e.style.left="0",e.style.width="100vw",e.style.height="100vh",e.style.zIndex="-1",document.body.appendChild(e),document.addEventListener("keydown",n=>{qt.forEach(t=>{t.enableKey(n)&&t.cube.matchKeyToTurn(n)})}),e}function vn(e){return e.getContext("webgl")}function bn(e){const i=Rn(e,`
    attribute vec4 aVertexPosition;
    attribute vec4 aVertexColor;
    uniform mat4 uTransformMatrix;
    uniform mat4 uRotateMatrix;

    // variables shared between vertex and fragment shaders
    varying lowp vec4 vColor;
    varying lowp vec4 originalPos;
    varying lowp vec4 rotatedPos;
    void main(void) {
        gl_Position = uTransformMatrix * aVertexPosition;
        originalPos = aVertexPosition;
        rotatedPos = uRotateMatrix * aVertexPosition;
        vColor = aVertexColor;
    }
    `,`
    // variables shared between vertex and fragment shaders
    varying lowp vec4 vColor;
    varying lowp vec4 originalPos;
    varying lowp vec4 rotatedPos;

    void main(void) {
        gl_FragColor = vColor;

        // low precision float variable
        lowp float max = 1.05;

        // if it is a normal sticker rather than a hint sticker, it should not be discarded
        if (originalPos.x < max && originalPos.x > -max && originalPos.y < max && originalPos.y > -max && originalPos.z < max && originalPos.z > -max) {
            return;
        }

        // if it starts on the right or left, and stays on its side, it should not be discarded
        if (originalPos.x > max && rotatedPos.x > max) return;
        if (originalPos.x < -max && rotatedPos.x < -max) return;

        if (rotatedPos.y < max && rotatedPos.z < max) return;
        discard;
    }
    `);return e.useProgram(i),{attribLocations:{vertexPosition:e.getAttribLocation(i,"aVertexPosition"),vertexColor:e.getAttribLocation(i,"aVertexColor")},uniformLocations:{transformMatrix:e.getUniformLocation(i,"uTransformMatrix"),rotateMatrix:e.getUniformLocation(i,"uRotateMatrix")}}}let qt=[],Ae=[],ce=Date.now()*.001,ae=!1;function kn(){ae||(ae=!0,requestAnimationFrame(Te))}function An(e,n=3){let t=Tn(e),i=new un(_,t);i.setNumOfLayers(n);let s=new xn,r=new dn,c={cube:i,dragEnabled:!0,enableKey:d=>!0},o={cube:i,div:e,spring:s};const l=(d,y)=>{c.dragEnabled&&r.onPointerDown(d,y,e,c.cube)},a=(d,y)=>{c.dragEnabled&&r.onPointerMove(d,y)},h=()=>{c.dragEnabled&&r.onPointerUp(e,c.cube)},u=d=>{const y=d.target.getBoundingClientRect(),g=d.touches[0].pageX-y.left,v=d.touches[0].pageY-y.top;return{x:g,y:v}},m=()=>{e.addEventListener("pointerdown",d=>l(d.offsetX,d.offsetY)),e.addEventListener("pointermove",d=>a(d.offsetX,d.offsetY)),e.addEventListener("pointerup",()=>h())},f=()=>{e.addEventListener("touchstart",d=>{const{x:y,y:g}=u(d);l(y,g)}),e.addEventListener("touchmove",d=>{const{x:y,y:g}=u(d);a(y,g)}),e.addEventListener("touchend",()=>{h()})};return window.PointerEvent?m():f(),e.style.touchAction="none",qt.push(c),Ae.push(o),kn(),c}function Tn(e){let n=gt();return yn(n,50*Math.PI/180,e.clientWidth/e.clientHeight,.1,100),mn(n,[0,0,-5]),Tt(n,n,45*Math.PI/180,[1,0,0]),Tt(n,n,0,[0,-1,0]),n}function Bt(e,n,t){t.bindBuffer(t.ARRAY_BUFFER,e),t.vertexAttribPointer(n.attribLocations.vertexPosition,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(n.attribLocations.vertexPosition)}function Ft(e,n,t){t.bindBuffer(t.ARRAY_BUFFER,e),t.vertexAttribPointer(n.attribLocations.vertexColor,4,t.FLOAT,!1,0,0),t.enableVertexAttribArray(n.attribLocations.vertexColor)}function It(e){e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}function Rn(e,n,t){const i=le(e,e.VERTEX_SHADER,n),s=le(e,e.FRAGMENT_SHADER,t),r=e.createProgram();return e.attachShader(r,i),e.attachShader(r,s),e.linkProgram(r),e.getProgramParameter(r,e.LINK_STATUS)?r:(alert("Unable to initialize the shader program: "+e.getProgramInfoLog(r)),null)}function le(e,n,t){const i=e.createShader(n);return e.shaderSource(i,t),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)?i:(alert("An error occurred compiling the shaders: "+e.getShaderInfoLog(i)),e.deleteShader(i),null)}function Sn(){const e=L.clientWidth,n=L.clientHeight,t=L.width!==e||L.height!==n;return t&&(L.width=e,L.height=n),t}function Te(e){e*=.001;const n=e-ce;ce=e,Sn(),_.enable(_.DEPTH_TEST),_.enable(_.SCISSOR_TEST),_.depthFunc(_.LEQUAL),_.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT);for(let t=0;t<qt.length;t++){const{cube:i,div:s,spring:r}=Ae[t],c=s.getBoundingClientRect();if(c.bottom<0||c.top>L.clientHeight||c.right<0||c.left>L.clientWidth)continue;const o=c.right-c.left,l=c.bottom-c.top,a=c.left,h=L.clientHeight-c.bottom;_.viewport(a,h,o,l),_.scissor(a,h,o,l),i.animationQueue[0]&&(r.target=i.animationQueue.length*90,r.update(n),r.position>=90&&(i.affectedStickers=Array(T(i.layers)).fill(!1),r.position=0,i.animationQueue.shift()));const u=i.animationQueue[0];let m=En(i),f=oe(),d=oe();for(let y=0;y<T(i.layers);y++){let g=i.buffers[y];const v=u&&u.stickersToAnimate[y]?f(()=>Tt(gt(),i.perspectiveMatrix,r.position*Math.PI/180,u.axis)):i.perspectiveMatrix;_.uniformMatrix4fv(N.uniformLocations.transformMatrix,!1,v);const R=u&&u.stickersToAnimate[y]?d(()=>{const k=gt();return Tt(k,k,r.position*Math.PI/180,u.axis)}):gt();_.uniformMatrix4fv(N.uniformLocations.rotateMatrix,!1,R),_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,g.indexBuffer),Bt(g.positionBuffer,N,_),Ft(m[y].buffer,N,_),It(_),Bt(g.noGapPositionBuffer,N,_),Ft(i.underStickers[y].buffer,N,_),It(_),Bt(g.hintPositionBuffer,N,_),Ft(m[y].buffer,N,_),It(_)}}requestAnimationFrame(Te)}function En(e){return e.animationQueue[0]?e.animationQueue[0].stickers:e.stickers}function Mn(e){let n,t,i;return{c(){n=j("div"),t=j("div"),S(t,"class","gl-div svelte-xxjnyc"),S(n,"class",i=_t(e[1].class)+" svelte-xxjnyc")},m(s,r){Qt(s,n,r),q(n,t),e[3](t)},p(s,[r]){r&2&&i!==(i=_t(s[1].class)+" svelte-xxjnyc")&&S(n,"class",i)},i:w,o:w,d(s){s&&ft(n),e[3](null)}}}function wn(e,n,t){let{onSceneInitialized:i}=n,s,r;pe(()=>{r=An(s),r.enableKey=o=>{const l=o.target;return l.tagName!=="INPUT"&&l.tagName!=="TEXTAREA"&&l.tagName!=="SELECT"},i(r)});function c(o){Kt[o?"unshift":"push"](()=>{s=o,t(0,s)})}return e.$$set=o=>{t(1,n=lt(lt({},n),xt(o))),"onSceneInitialized"in o&&t(2,i=o.onSceneInitialized)},n=xt(n),[s,n,i,c]}class Zn extends Et{constructor(n){super(),St(this,n,wn,Mn,Rt,{onSceneInitialized:2})}}function Pn(e){let n,t,i,s,r,c,o,l;return r=new be({props:{name:"x",class:"x-icon",style:"padding: 4px;"}}),r.$on("click",e[2]),{c(){n=j("div"),t=j("div"),i=j("h5"),i.textContent="Menu",s=Jt(),ve(r.$$.fragment),c=Jt(),o=j("div"),o.innerHTML=`<div style="height: 8px;"></div> 
        <a href="learn.html"><button style="width: 100%;">Learn</button></a> 
        <div style="height: 8px;"></div> 
        <a href="play.html"><button style="width: 100%;">Play</button></a> 
        <div style="height: 8px;"></div> 
        <a href="train.html"><button style="width: 100%;">Train</button></a> 
        <div style="height: 8px;"></div> 
        <a href="cuble.html"><button style="width: 100%;">Cuble</button></a>`,X(i,"color","white"),X(i,"font-size","1.2rem"),S(t,"class","row"),X(t,"justify-content","space-between"),X(t,"padding","8px"),X(o,"display","flex"),X(o,"flex-direction","column"),X(o,"padding","0 8px"),S(n,"id",Re),S(n,"style",e[1])},m(a,h){Qt(a,n,h),q(n,t),q(t,i),q(t,s),Wt(r,t,null),q(n,c),q(n,o),l=!0},p(a,[h]){(!l||h&2)&&S(n,"style",a[1])},i(a){l||(Vt(r.$$.fragment,a),l=!0)},o(a){_e(r.$$.fragment,a),l=!1},d(a){a&&ft(n),Xt(r)}}}const Re="side-nav";function Ln(e,n,t){let i,{open:s}=n,r;pe(()=>{document.addEventListener("click",o=>{if(Date.now()-r<100)return;const a=o.target.closest(`#${Re}`);s&&!a&&t(0,s=!1)})});const c=()=>t(0,s=!1);return e.$$set=o=>{"open"in o&&t(0,s=o.open)},e.$$.update=()=>{e.$$.dirty&1&&s&&(r=Date.now()),e.$$.dirty&1&&t(1,i=`position: fixed; top: 0; left: 0; width: 300px; height: 100%; background-color: var(--gray-700); z-index: 10; ${s?"transform: translateX(0); transition: transform 0.3s ease-in-out":"transform: translateX(-100%); transition: transform 0.3s ease-in-out"}`)},[s,i,c]}class Jn extends Et{constructor(n){super(),St(this,n,Ln,Pn,Rt,{open:0})}}function On(e){let n,t;return n=new be({props:{name:e[0],class:"icon",style:"padding: 8px;"}}),n.$on("click",e[1]),{c(){ve(n.$$.fragment)},m(i,s){Wt(n,i,s),t=!0},p(i,[s]){const r={};s&1&&(r.name=i[0]),n.$set(r)},i(i){t||(Vt(n.$$.fragment,i),t=!0)},o(i){_e(n.$$.fragment,i),t=!1},d(i){Xt(n,i)}}}function Cn(e,n,t){let{name:i}=n;function s(r){ge.call(this,e,r)}return e.$$set=r=>{"name"in r&&t(0,i=r.name)},[i,s]}class ti extends Et{constructor(n){super(),St(this,n,Cn,On,Rt,{name:0})}}export{w as A,zn as B,lt as C,xt as D,Lt as E,qn as F,Zn as G,zt as H,be as I,Un as J,Qn as K,$n as L,rt as M,ti as N,Vn as O,Wn as P,Gn as Q,pe as R,Et as S,Hn as T,jn as U,Kn as V,Jn as a,Kt as b,Xn as c,ve as d,j as e,Jt as f,S as g,X as h,St as i,Qt as j,q as k,we as l,Wt as m,Nn as n,Yn as o,Vt as p,_e as q,ft as r,Rt as s,me as t,Xt as u,J as v,Dn as w,Fn as x,In as y,Bn as z};
